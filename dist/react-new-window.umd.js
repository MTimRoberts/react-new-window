(function(a,p){typeof exports=="object"&&typeof module<"u"?module.exports=p(require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["react","react-dom"],p):(a=typeof globalThis<"u"?globalThis:a||self,a.ReactNewWindow=p(a.React,a.ReactDOM))})(this,function(a,p){"use strict";const S=(e=>e&&typeof e=="object"&&"default"in e?e:{default:e})(p);function v(e){return e.cssText.split("url(").map(t=>t[1]==="/"?`${t.slice(0,1)}${window.location.origin}${t.slice(1)}`:t).join("url(")}function x(e){const t=["@keyframes",e.name,"{"];return Array.from(e.cssRules).forEach(c=>{t.push(c.keyText,"{",c.style.cssText,"}")}),t.push("}"),t.join(" ")}function W(e,t){const c=t.createDocumentFragment();Array.from(e.styleSheets).forEach(r=>{let n;try{n=r.cssRules}catch(i){console.error(i)}if(n&&Object.values(n).some(i=>i instanceof CSSFontFaceRule)&&r.href,n){const i=[];Array.from(r.cssRules).forEach(s=>{const{type:o}=s;if(o===0)return;let l="";o===CSSRule.KEYFRAMES_RULE?l=x(s):[CSSRule.IMPORT_RULE,CSSRule.FONT_FACE_RULE].includes(o)?l=v(s):l=s.cssText,i.push(l)});const f=t.createElement("style");f.textContent=i.join(`
`),c.appendChild(f)}else if(r.href){const i=t.createElement("link");i.rel="stylesheet",i.href=r.href,c.appendChild(i)}}),t.head.appendChild(c)}const b=e=>e.nodeType===Node.ELEMENT_NODE;function O(e){return Object.keys(e).reduce((t,c)=>{const r=e[c];return typeof r=="boolean"?t.push(`${c}=${r?"yes":"no"}`):t.push(`${c}=${r}`),t},[]).join(",")}const w={url:"",name:"",title:"",features:{width:"600px",height:"640px"},center:"parent",copyStyles:!0,closeOnUnmount:!0},R=e=>{const{url:t=w.url,name:c=w.name,title:r=w.title,features:n=w.features,center:i=w.center,copyStyles:f=w.copyStyles,closeOnUnmount:s=w.closeOnUnmount,onOpen:o,onUnload:l,onBlock:u,children:m}=e,[d,N]=a.useState();if(a.useEffect(function(){const g=L({url:t,title:r,name:c,features:n,center:i,copyStyles:f,closeOnUnmount:s,onOpen:o,onUnload:l,onBlock:u});g&&N(g);const k=setInterval(()=>{(!d||d.closed)&&C()},50),C=()=>{clearInterval(k),l&&l()};return d&&d.addEventListener("beforeunload",()=>C()),()=>{if(d){if(s)d.close();else if(e.children){const T=h(d);if(T){const E=T.cloneNode(!0);b(E)&&(E.setAttribute("id","new-window-container-static"),d.document.body.appendChild(E))}}}}},[]),d){const y=h(d);if(y)return S.default.createPortal(m,y)}return null},L=e=>{const{url:t,title:c=w.title,name:r,features:n=w.features,onBlock:i,onOpen:f,center:s}=e;if(typeof s=="string"&&((n==null?void 0:n.width)===void 0||(n==null?void 0:n.height)===void 0))console.warn("react-new-window: width and height window features must be present when a center prop is provided");else if(s==="parent")window.top===null?console.warn("react-new-window: can't access parent window"):(n.left=window.top.outerWidth/2+window.top.screenX-n.width/2,n.top=window.top.outerHeight/2+window.top.screenY-n.height/2);else if(s==="screen"){const l=window.screenLeft!==void 0?window.screenLeft:"left"in window.screen?window.screen.left:0,u=window.screenTop!==void 0?window.screenTop:"top"in window.screen?window.screen.top:0,m=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,d=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height;n.left=m/2-n.width/2+l,n.top=d/2-n.height/2+u}const o=window.open(t,r,O(n));if(o){if(o.document.title=c,!!h(o)){const u=o.document.getElementById("new-window-container-static");u&&o.document.body.removeChild(u)}else{const u=o.document.createElement("div");u.setAttribute("id","new-window-container"),o.document.body.appendChild(u)}e.copyStyles&&setTimeout(()=>W(document,o.document),0),f&&f(o)}else i?i():console.warn("react-new-window: A new window could not be opened. Maybe it was blocked.");return o},h=e=>e.document.getElementById("new-window-container");return R});
